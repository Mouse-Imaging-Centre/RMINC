<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Threshold Free Cluster Enhancement — vertexTFCE • RMINC</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Threshold Free Cluster Enhancement — vertexTFCE" />

<meta property="og:description" content="Perform threshold free cluster enhancement as described in 
Smith and Nichols (2008). Cluster-like structures are enhanced
to allow a hybrid cluster/voxel analysis to be performed." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RMINC</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">1.5.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/Mouse-Imaging-Centre/RMINC">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Threshold Free Cluster Enhancement</h1>
    <small class="dont-index">Source: <a href='https://github.com/Mouse-Imaging-Centre/RMINC/blob/master/R/minc_vertex_statistics.R'><code>R/minc_vertex_statistics.R</code></a></small>
    <div class="hidden name"><code>vertexTFCE.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Perform threshold free cluster enhancement as described in 
Smith and Nichols (2008). Cluster-like structures are enhanced
to allow a hybrid cluster/voxel analysis to be performed.</p>
    
    </div>

    <pre class="usage"><span class='fu'>vertexTFCE</span>(<span class='no'>x</span>, <span class='no'>...</span>)

<span class='co'># S3 method for numeric</span>
<span class='fu'>vertexTFCE</span>(<span class='no'>x</span>, <span class='no'>surface</span>, <span class='kw'>E</span> <span class='kw'>=</span> <span class='fl'>0.5</span>, <span class='kw'>H</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>nsteps</span> <span class='kw'>=</span> <span class='fl'>100</span>,
  <span class='kw'>side</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"both"</span>, <span class='st'>"positive"</span>, <span class='st'>"negative"</span>), <span class='kw'>weights</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>)

<span class='co'># S3 method for matrix</span>
<span class='fu'>vertexTFCE</span>(<span class='no'>x</span>, <span class='no'>surface</span>, <span class='kw'>E</span> <span class='kw'>=</span> <span class='fl'>0.5</span>, <span class='kw'>H</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>nsteps</span> <span class='kw'>=</span> <span class='fl'>100</span>,
  <span class='kw'>side</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"both"</span>, <span class='st'>"positive"</span>, <span class='st'>"negative"</span>), <span class='kw'>weights</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>)

<span class='co'># S3 method for vertexLm</span>
<span class='fu'>vertexTFCE</span>(<span class='no'>x</span>, <span class='no'>surface</span>, <span class='kw'>R</span> <span class='kw'>=</span> <span class='fl'>500</span>,
  <span class='kw'>alternative</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"two.sided"</span>, <span class='st'>"greater"</span>), <span class='kw'>E</span> <span class='kw'>=</span> <span class='fl'>0.5</span>, <span class='kw'>H</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>nsteps</span> <span class='kw'>=</span> <span class='fl'>100</span>,
  <span class='kw'>weights</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>side</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"both"</span>, <span class='st'>"positive"</span>, <span class='st'>"negative"</span>),
  <span class='kw'>replace</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>parallel</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>)

<span class='co'># S3 method for character</span>
<span class='fu'>vertexTFCE</span>(<span class='no'>x</span>, <span class='no'>surface</span>, <span class='kw'>E</span> <span class='kw'>=</span> <span class='fl'>0.5</span>, <span class='kw'>H</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>nsteps</span> <span class='kw'>=</span> <span class='fl'>100</span>,
  <span class='kw'>side</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"both"</span>, <span class='st'>"positive"</span>, <span class='st'>"negative"</span>), <span class='kw'>weights</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>A numeric vector, a filepath to a set of values,
or a <code>matrix</code> object, or <code>vertexLm</code> object.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional arguments for methods</p></td>
    </tr>
    <tr>
      <th>surface</th>
      <td><p>Either a mesh object corresponding to the surface,
an igraph graph object of surface created by <a href='obj_to_graph.html'>obj_to_graph</a>, or an adjacency list (see details). 
For the <code>matrix</code> and <a href='vertexLm.html'>vertexLm</a> cases, either a single surface object may be passed and
used for each individual, or a vector of file names</p></td>
    </tr>
    <tr>
      <th>E</th>
      <td><p>The exponent by which to raise the extent statistic (default .5)</p></td>
    </tr>
    <tr>
      <th>H</th>
      <td><p>The exponent by which to raise the height (default 2)</p></td>
    </tr>
    <tr>
      <th>nsteps</th>
      <td><p>The number of steps to discretize the TFCE computation over</p></td>
    </tr>
    <tr>
      <th>side</th>
      <td><p>Whether to consider positive and negative statistics or both (default both)</p></td>
    </tr>
    <tr>
      <th>weights</th>
      <td><p>A weighting vector assigning area to vertices. The default varies by 
<code>surface</code> object type. If <code>surface</code> is an <code>bic_obj</code> the area of each
vertex is equal to 1/3 the sum of the areas of the triangles it is a member of. If <code>surface</code>
is an <code>igraph</code> or adjacency list the default is a vector of ones.</p></td>
    </tr>
    <tr>
      <th>R</th>
      <td><p>number of randomizations to perform</p></td>
    </tr>
    <tr>
      <th>alternative</th>
      <td><p>Whether to consider a one-sided or two-sided alternative hypothesis. Default
"two-sided", use "greater" for a one sided test.</p></td>
    </tr>
    <tr>
      <th>replace</th>
      <td><p>Sample with or without replacement for the randomization, defaults to FALSE (no
replacement)</p></td>
    </tr>
    <tr>
      <th>parallel</th>
      <td><p>A two component vector indicating how to parallelize the computation. If the 
first element is "local" the computation will be run via the parallel package, otherwise it will
be computed using batchtools, see <a href='pMincApply.html'>pMincApply</a> for details. The element should be numeric
indicating the number of jobs to split the computation into.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The behaviour of <code>vertexTFCE</code> is to perform cluster free enhancement on a object,
in the single dimensional case, a string denoting a vertex file or a numeric vector
it returns a numeric vector with the result. In the matrix case each column is cluster enhanced and 
recomposed into a matrix.
In the <a href='vertexLm.html'>vertexLm</a> case a randomization test is performed on each t-tstatistic column. The results is
a list with 3 elements</p><ul>
<li><p>TFCE: A matrix of the tvalue columns after randomization</p></li>
<li><p>randomization_dist: An RxT matrix where R is the number of randomizations and T is the number of t-statistics,
elements are the largest value obtained by the randomized TFCE</p></li>
<li><p>args: Arguments passed to the internal randomzations and TFCE code</p></li>
</ul>

    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Passing an adjacency list will save some compute time
but is not recommended for general use. If an adjacency list is passed should index starting from 0 for compatibility with c++
code. Adjacency lists of this kind can be generated from graphs with <code>lapply(as_adj_list(graph), `-`, 1)</code>
using the <a href='http://www.rdocumentation.org/packages/igraph/topics/as_adj_list'>as_adj_list</a> from the igraph library.</p>
    
    <h2 class="hasAnchor" id="methods-by-class-"><a class="anchor" href="#methods-by-class-"></a>Methods (by class)</h2>

    <ul>
<li><p><code>numeric</code>: numeric</p></li>
<li><p><code>matrix</code>: matrix</p></li>
<li><p><code>vertexLm</code>: vertexLm</p></li>
<li><p><code>character</code>: character</p></li>
</ul>
    

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#methods-by-class-">Methods (by class)</a></li>
          </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Jason Lerch, Chris Hammill, Matthijs van Eede, Daniel Cassel.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

